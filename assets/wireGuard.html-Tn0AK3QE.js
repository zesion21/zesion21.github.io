import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a,o as n}from"./app-DQ5ndBT9.js";const l={};function t(r,s){return n(),e("div",null,[...s[0]||(s[0]=[a(`<h3 id="一、安装-wireguard" tabindex="-1"><a class="header-anchor" href="#一、安装-wireguard"><span>一、安装 WireGuard</span></a></h3><p>参考：<a href="https://www.wireguard.com/install/" target="_blank" rel="noopener noreferrer">https://www.wireguard.com/install/</a></p><ol><li><p>Windows 版本下载地址：<a href="https://download.wireguard.com/windows-client/" target="_blank" rel="noopener noreferrer">https://download.wireguard.com/windows-client/</a></p></li><li><p>Ubuntu(Debian)安装：</p></li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> update</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> apt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wireguard</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="二、服务端配置" tabindex="-1"><a class="header-anchor" href="#二、服务端配置"><span>二、服务端配置</span></a></h3><ol><li>生成服务器密钥对</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> umask</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 077</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> genkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tee</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/wireguard/privatekey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pubkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tee</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/wireguard/publickey</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>创建服务器配置文件 <code>/etc/wireguard/wg0.conf</code></li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[Interface]</span></span>
<span class="line"><span>Address = 172.16.10.1/24</span></span>
<span class="line"><span>ListenPort = 5555</span></span>
<span class="line"><span>PrivateKey = &lt;服务器私钥&gt;</span></span>
<span class="line"><span>PostUp = iptables -I FORWARD 1 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT; iptables -I FORWARD 2 -i %i -j ACCEPT; iptables -t nat -I POSTROUTING 1 -s 172.16.10.0/24 -o eth0 -j MASQUERADE</span></span>
<span class="line"><span>PostDown = iptables -D FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT; iptables -D FORWARD -i %i -j ACCEPT; iptables -t nat -D POSTROUTING -s 172.16.10.0/24 -o eth0 -j MASQUERADE</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Peer]</span></span>
<span class="line"><span># 这是对端VPS-A的信息</span></span>
<span class="line"><span># 稍后在VPS-A上生成公钥后，填入此处</span></span>
<span class="line"><span>PublicKey = &lt;客户端公钥&gt;</span></span>
<span class="line"><span># 分配给VPS-A的私有IP地址</span></span>
<span class="line"><span>AllowedIPs = 172.16.10.2/32</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>启用IP转发：为了让服务器能转发客户端的流量，需要启用内核的IP转发功能</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">echo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;net.ipv4.ip_forward=1&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tee</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/sysctl.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="4"><li>有防火墙的话，需要配置防火墙</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo ufw allow 51820/udp</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="5"><li>启动WireGuard服务</li></ol><p>使用<code>wg-quick</code>工具启动刚才配置的<code>wg0</code>接口，并设置开机自启</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>sudo systemctl enable wg-quick@wg0 --now</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>检查服务状态和接口：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wg-quick@wg0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="三、客户端配置" tabindex="-1"><a class="header-anchor" href="#三、客户端配置"><span>三、客户端配置</span></a></h3><ol><li>创建客户端密钥对</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> genkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tee</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> client-private.key</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">wg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pubkey</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">client-public.key</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>在服务器配置中添加客户端(已添加)，多个客户端添加多个 <code>[Peer]</code></li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[Peer]</span></span>
<span class="line"><span>PublicKey = &lt;客户端公钥&gt;</span></span>
<span class="line"><span>AllowedIPs = 10.0.0.2/32</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>创建客户端配置文件</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>[Interface]</span></span>
<span class="line"><span>PrivateKey = &lt;客户端私钥&gt;</span></span>
<span class="line"><span>Address = 172.16.10.2/24</span></span>
<span class="line"><span>DNS = 114.114.114.114</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Peer]</span></span>
<span class="line"><span>Endpoint = 192.168.10.13:5555</span></span>
<span class="line"><span>PublicKey = &lt;服务端公钥&gt;</span></span>
<span class="line"><span>AllowedIPs = 172.16.10.0/24</span></span>
<span class="line"><span>PersistentKeepalive = 25</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="四、常见问题" tabindex="-1"><a class="header-anchor" href="#四、常见问题"><span>四、常见问题：</span></a></h3><ol><li><code>iptables: command not found</code> :<br><code>sudo apt install iptables</code></li></ol>`,27)])])}const h=i(l,[["render",t]]),c=JSON.parse('{"path":"/article/server/2026/wireGuard.html","title":"使用 WireGuard 实现局域网组建","lang":"zh-CN","frontmatter":{"title":"使用 WireGuard 实现局域网组建","date":"2026-02-25T00:00:00.000Z","tags":["windows","linux"],"categories":["Server"],"description":"一、安装 WireGuard 参考：https://www.wireguard.com/install/ Windows 版本下载地址：https://download.wireguard.com/windows-client/ Ubuntu(Debian)安装： 二、服务端配置 生成服务器密钥对 创建服务器配置文件 /etc/wireguard/wg...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"使用 WireGuard 实现局域网组建\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2026-02-25T00:00:00.000Z\\",\\"dateModified\\":\\"2026-02-25T10:20:20.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"阿琛\\",\\"url\\":\\"http://zesionlee.cn\\"}]}"],["meta",{"property":"og:url","content":"http://zesionlee.cn/article/server/2026/wireGuard.html"}],["meta",{"property":"og:site_name","content":"全栈笔记"}],["meta",{"property":"og:title","content":"使用 WireGuard 实现局域网组建"}],["meta",{"property":"og:description","content":"一、安装 WireGuard 参考：https://www.wireguard.com/install/ Windows 版本下载地址：https://download.wireguard.com/windows-client/ Ubuntu(Debian)安装： 二、服务端配置 生成服务器密钥对 创建服务器配置文件 /etc/wireguard/wg..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2026-02-25T10:20:20.000Z"}],["meta",{"property":"article:tag","content":"linux"}],["meta",{"property":"article:tag","content":"windows"}],["meta",{"property":"article:published_time","content":"2026-02-25T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-25T10:20:20.000Z"}],["link",{"rel":"alternate","hreflang":"en-us","href":"http://zesionlee.cn/en/article/server/2026/wireGuard.html"}]]},"git":{"createdTime":1772000831000,"updatedTime":1772014820000,"contributors":[{"name":"zesion21","username":"zesion21","email":"39211025+zesion21@users.noreply.github.com","commits":2,"url":"https://github.com/zesion21"}]},"readingTime":{"minutes":1.45,"words":434},"filePathRelative":"article/server/2026/wireGuard.md","excerpt":"<h3>一、安装 WireGuard</h3>\\n<p>参考：<a href=\\"https://www.wireguard.com/install/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://www.wireguard.com/install/</a></p>\\n<ol>\\n<li>\\n<p>Windows 版本下载地址：<a href=\\"https://download.wireguard.com/windows-client/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">https://download.wireguard.com/windows-client/</a></p>\\n</li>\\n<li>\\n<p>Ubuntu(Debian)安装：</p>\\n</li>\\n</ol>","autoDesc":true}');export{h as comp,c as data};
