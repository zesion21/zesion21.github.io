import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,b as n}from"./app-CFuNIExP.js";const l={},t=n(`<h1 id="关于-gdal-使用的一些总结-代码" tabindex="-1"><a class="header-anchor" href="#关于-gdal-使用的一些总结-代码"><span>关于 gdal 使用的一些总结（代码）</span></a></h1><ol><li>获取 tif 的范围</li></ol><div class="language-kotlin line-numbers-mode" data-highlighter="shiki" data-ext="kotlin" data-title="kotlin" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">fun</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> getExtent</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(path: </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">String</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">) {</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">AllRegister</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> driver </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">GetDriverByName</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;GTiff&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Open</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(path)</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> x </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.rasterXSize</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> y </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.rasterYSize</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> transforme </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">GetGeoTransform</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> west </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> transforme[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">0</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">]</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dx </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> transforme[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">1</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">]</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> north </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> transforme[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">3</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">]</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dy </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> transforme[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">5</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> east </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> west </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">+</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dx </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">*</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> x</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> sourth </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> north </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">+</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dy </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">*</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> y</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">            println</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">west</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">,</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">east</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">,</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">north</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">,</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">sourth</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">//            val ds = ogr.Open(path)</span></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">//            println(layer.GetExtent())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>合并多个 tif</li></ol><div class="language-kotlin line-numbers-mode" data-highlighter="shiki" data-ext="kotlin" data-title="kotlin" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">      fun</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> union</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(path0: </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">String</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, name: </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">String</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">): </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">String</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> {</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">AllRegister</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> d0 </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Open</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(path0)</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> d1 </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Open</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">base</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">img_cr/</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">name</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Warp</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">base</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">union/</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">name</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">listOf</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&lt;</span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">Dataset</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&gt;(d0, d1).</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">toTypedArray</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(), </span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">null</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">            //解决资源占用的问题</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">GDALDestroyDriverManager</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">            return</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">base</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">union/</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">name</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>去除 tif 黑边（只能是 tif）</li></ol><div class="language-kotlin line-numbers-mode" data-highlighter="shiki" data-ext="kotlin" data-title="kotlin" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">    fun</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> nearBlack</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(photo: </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">Photo</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">) {</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">          gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">AllRegister</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">          val</span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;"> data</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;"> =</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Open</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">base</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">tif</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${photo.File}.tif&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">          val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> vector </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> Vector</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&lt;</span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">String</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&gt;()</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">          &quot;-of GTiff -setalpha&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">split</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot; &quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">).</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">forEach</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> { vector.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">add</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(it) }</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">          gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Nearblack</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">base</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">tif</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${photo.File}.tif&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">data</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">NearblackOptions</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(vector))</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">      }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="4"><li>转为指定坐标系的 wkt</li></ol><div class="language-kotlin line-numbers-mode" data-highlighter="shiki" data-ext="kotlin" data-title="kotlin" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">     val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> proj4_ </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">     private</span><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> fun</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> toWKt</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(feature: </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">Feature</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">): </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">String</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> {</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> geom </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> feature.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">GetGeometryRef</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> proj4 </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> geom.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">GetSpatialReference</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">().</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">ExportToProj4</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">            if</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> (</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">!</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">proj4.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">equals</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(proj4_)) {</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">                val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> sp </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> SpatialReference</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">                sp.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">ImportFromProj4</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(proj4_)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">                geom.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">TransformTo</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(sp)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            }</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            geom.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">FlattenTo2D</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">            return</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> geom.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">ExportToWkt</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="5"><li>将 tif 转为 rgb 三波段的 tif（可解决 union 时变花的问题）</li></ol><div class="language-kotlin line-numbers-mode" data-highlighter="shiki" data-ext="kotlin" data-title="kotlin" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">fun</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> handleListTif2Rgb</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(z: </span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">Int</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">) {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">    val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> vector </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> Vector</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&lt;</span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">String</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&gt;()</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    vector.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">addElement</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;-expand&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    vector.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">addElement</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;RGB&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">    val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> parent </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;E:</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">img2tif</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${z}_tif</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">    val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> parent2 </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;E:</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">img2tif</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${z}_tif_rgb</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">    for</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> (it </span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">in</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> File</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(parent).</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">list</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">!!</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">) {</span></span>
<span class="line"><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">        println</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;开始 </span><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">$it</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">        val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> yyy </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> File</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(parent </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">+</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> it).</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">list</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">!!</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">        val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> datas </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> mutableListOf</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&lt;</span><span style="--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit;">Dataset</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">&gt;()</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">        if</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> (</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">!</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">File</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">parent2</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${it}&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">).</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">exists</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()) </span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">File</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">parent2</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${it}&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">).</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">mkdir</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">        for</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> (i </span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">in</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> yyy.indices) {</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> it2 </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> yyy[i]</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">            val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> outPath </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">parent2</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${it}</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${it2}&quot;</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">            if</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> (</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">!</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">File</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(outPath).</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">exists</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">()) {</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">                val</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dsrc </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Open</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">parent</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}\${</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#50A14F;">it</span><span style="--shiki-dark:#F92672;--shiki-light:#50A14F;">}</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">\${it2}&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">                gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Translate</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(outPath, dsrc, </span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">TranslateOptions</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(vector))</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            }</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">            datas.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">add</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Open</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(outPath))</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        }</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        gdal.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">Warp</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;E:</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">img2tif</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">14_union</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\\\</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">$it.tif&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, datas.</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">toTypedArray</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(), </span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">null</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    }</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="6"><li>通过重采样修改 tif 分辨率</li></ol><ul><li>使用 warp 方法 <blockquote><p>参考：https://www.jianshu.com/p/821c741ff169</p></blockquote></li></ul><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">gdal.Warp(tif_out, tif_input, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">resampleAlg</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">gdalconst.</span><span style="--shiki-dark:#AE81FF;--shiki-light:#383A42;">GRA_NearestNeighbour</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">xRes</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">500</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">yRes</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">500</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li>使用 GeoTransform <blockquote><p>引用： https://blog.csdn.net/gisuuser/article/details/106304155</p></blockquote></li></ul><div class="language-py line-numbers-mode" data-highlighter="shiki" data-ext="py" data-title="py" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">from</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> osgeo </span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">import</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal, gdalconst</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">import</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> os</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">import</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> numpy </span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">as</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> np</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">def</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> resampling</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">source_file</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">,</span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> target_file</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">,</span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> scale</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">1.0</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">):</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">    影像重采样</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">    :param source_file: 源文件</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">    :param target_file: 输出影像</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">    :param scale: 像元缩放比例</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">    :return:</span></span>
<span class="line"><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    dataset </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> gdal.Open(source_file, gdalconst.</span><span style="--shiki-dark:#AE81FF;--shiki-light:#383A42;">GA_ReadOnly</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    band_count </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.RasterCount  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 波段数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">    if</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> band_count </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">==</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;"> 0</span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;"> or</span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;"> not</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> scale </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">&gt;</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;"> 0</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;">        print</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;参数异常&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">        return</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    cols </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.RasterXSize  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 列数</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    rows </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.RasterYSize  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 行数</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    cols </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> int</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(cols </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">*</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> scale)  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 计算新的行列数</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    rows </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> int</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(rows </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">*</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> scale)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    geotrans </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> list</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(dataset.GetGeoTransform())</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;">    print</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(dataset.GetGeoTransform())</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;">    print</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(geotrans)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    geotrans[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">1</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">] </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> geotrans[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">1</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">] </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">/</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> scale  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 像元宽度变为原来的scale倍</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    geotrans[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">5</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">] </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> geotrans[</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">5</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">] </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">/</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> scale  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 像元高度变为原来的scale倍</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;">    print</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(geotrans)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">    if</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> os.path.exists(target_file) </span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">and</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> os.path.isfile(target_file):  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 如果已存在同名影像</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        os.remove(target_file)  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 则删除之</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    band1 </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.GetRasterBand(</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">1</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    data_type </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> band1.DataType</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    target </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.GetDriver().Create(target_file, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">xsize</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">cols, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">ysize</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">rows, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">bands</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">band_count,</span></span>
<span class="line"><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">                                        eType</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">data_type)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    target.SetProjection(dataset.GetProjection())  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 设置投影坐标</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    target.SetGeoTransform(geotrans)  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 设置地理变换参数</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    total </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> band_count </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">+</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;"> 1</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">    for</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> index </span><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">in</span><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;"> range</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">1</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">, total):</span></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">        # 读取波段数据</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;">        print</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;正在写入&quot;</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;"> +</span><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> str</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(index) </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">+</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;波段&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        data </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset.GetRasterBand(index).ReadAsArray(</span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">buf_xsize</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">cols, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">buf_ysize</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">rows)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        out_band </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> target.GetRasterBand(index)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        out_band.SetNoDataValue(dataset.GetRasterBand(index).GetNoDataValue())</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        out_band.WriteArray(data)  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 写入数据到新影像中</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        out_band.FlushCache()</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">        out_band.ComputeBandStats(</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">False</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)  </span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;"># 计算统计信息</span></span>
<span class="line"><span style="--shiki-dark:#66D9EF;--shiki-light:#0184BC;">    print</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">(</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;正在写入完成&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">    del</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> dataset</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">    del</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;"> target</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#A626A4;">if</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;"> __name__</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;"> ==</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> &quot;__main__&quot;</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    source_file </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> r</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">&quot;E:</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\商</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">丘yx</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\相</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">交4.tiff&quot;</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    target_file </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> r</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">&quot;E:</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\商</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">丘yx</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\相</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">交411.tiff&quot;</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    resampling(source_file, target_file, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">scale</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">1.1</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    target_file </span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;"> r</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">&quot;E:</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\商</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">丘yx</span><span style="--shiki-dark:#AE81FF;--shiki-light:#0184BC;">\\相</span><span style="--shiki-dark:#E6DB74;--shiki-light:#0184BC;">交05.tiff&quot;</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">    resampling(source_file, target_file, </span><span style="--shiki-dark:#FD971F;--shiki-light:#986801;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit;">scale</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;">0.5</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16),h=[t];function k(e,p){return a(),s("div",null,h)}const d=i(l,[["render",k],["__file","gdal3.html.vue"]]),g=JSON.parse('{"path":"/article/GIS/2024/gdal3.html","title":"关于 gdal 使用的一些总结（代码）","lang":"zh-CN","frontmatter":{"date":"2024-08-12T00:00:00.000Z","tag":["gdal"],"category":["GIS相关"],"description":"关于 gdal 使用的一些总结（代码） 获取 tif 的范围 合并多个 tif 去除 tif 黑边（只能是 tif） 转为指定坐标系的 wkt 将 tif 转为 rgb 三波段的 tif（可解决 union 时变花的问题） 通过重采样修改 tif 分辨率 使用 warp 方法 参考：https://www.jianshu.com/p/821c741ff...","head":[["meta",{"property":"og:url","content":"http://zesionlee.cn/article/GIS/2024/gdal3.html"}],["meta",{"property":"og:site_name","content":"全栈笔记"}],["meta",{"property":"og:title","content":"关于 gdal 使用的一些总结（代码）"}],["meta",{"property":"og:description","content":"关于 gdal 使用的一些总结（代码） 获取 tif 的范围 合并多个 tif 去除 tif 黑边（只能是 tif） 转为指定坐标系的 wkt 将 tif 转为 rgb 三波段的 tif（可解决 union 时变花的问题） 通过重采样修改 tif 分辨率 使用 warp 方法 参考：https://www.jianshu.com/p/821c741ff..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-08-12T02:27:51.000Z"}],["meta",{"property":"article:author","content":"阿琛"}],["meta",{"property":"article:tag","content":"gdal"}],["meta",{"property":"article:published_time","content":"2024-08-12T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-08-12T02:27:51.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"关于 gdal 使用的一些总结（代码）\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-08-12T00:00:00.000Z\\",\\"dateModified\\":\\"2024-08-12T02:27:51.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"阿琛\\",\\"url\\":\\"http://zesionlee.cn\\"}]}"]]},"headers":[],"git":{"createdTime":1723429671000,"updatedTime":1723429671000,"contributors":[{"name":"zesionlee","email":"39211025+zesion21@users.noreply.github.com","commits":1}]},"readingTime":{"minutes":2.31,"words":692},"filePathRelative":"article/GIS/2024/gdal3.md","localizedDate":"2024年8月12日","excerpt":"\\n<ol>\\n<li>获取 tif 的范围</li>\\n</ol>\\n<div class=\\"language-kotlin line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"kotlin\\" data-title=\\"kotlin\\" style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA\\"><pre class=\\"shiki shiki-themes monokai one-light vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">fun</span><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#4078F2\\"> getExtent</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">(path: </span><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#C18401;--shiki-dark-text-decoration:underline;--shiki-light-text-decoration:inherit\\">String</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">) {</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">            gdal.</span><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#4078F2\\">AllRegister</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">()</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> driver </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> gdal.</span><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#4078F2\\">GetDriverByName</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">(</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\">\\"GTiff\\"</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dataset </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> gdal.</span><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#4078F2\\">Open</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">(path)</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> x </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dataset.rasterXSize</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> y </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dataset.rasterYSize</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> transforme </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dataset.</span><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#4078F2\\">GetGeoTransform</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">()</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> west </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> transforme[</span><span style=\\"--shiki-dark:#AE81FF;--shiki-light:#986801\\">0</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">]</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dx </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> transforme[</span><span style=\\"--shiki-dark:#AE81FF;--shiki-light:#986801\\">1</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">]</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> north </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> transforme[</span><span style=\\"--shiki-dark:#AE81FF;--shiki-light:#986801\\">3</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">]</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dy </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> transforme[</span><span style=\\"--shiki-dark:#AE81FF;--shiki-light:#986801\\">5</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">]</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> east </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> west </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">+</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dx </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">*</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> x</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#66D9EF;--shiki-light:#A626A4;--shiki-dark-font-style:italic;--shiki-light-font-style:inherit\\">            val</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> sourth </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">=</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> north </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">+</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> dy </span><span style=\\"--shiki-dark:#F92672;--shiki-light:#383A42\\">*</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\"> y</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#4078F2\\">            println</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">(</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\">\\"</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">${</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#50A14F\\">west</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">}</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\">,</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">${</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#50A14F\\">east</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">}</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\">,</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">${</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#50A14F\\">north</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">}</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\">,</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">${</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#50A14F\\">sourth</span><span style=\\"--shiki-dark:#F92672;--shiki-light:#50A14F\\">}</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\"> \\"</span><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic\\">//            val ds = ogr.Open(path)</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic\\">//            println(layer.GetExtent())</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42\\">        }</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{d as comp,g as data};
