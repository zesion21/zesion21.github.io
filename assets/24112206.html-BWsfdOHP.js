import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as a,b as n}from"./app-CFuNIExP.js";const e={},l=n(`<h1 id="docker-安装-nginx-并注册服务实现开机自启-systemctl-操作" tabindex="-1"><a class="header-anchor" href="#docker-安装-nginx-并注册服务实现开机自启-systemctl-操作"><span>docker 安装 nginx 并注册服务实现开机自启（systemctl 操作）</span></a></h1><h3 id="安装配置-nginx" tabindex="-1"><a class="header-anchor" href="#安装配置-nginx"><span>安装配置 nginx</span></a></h3><ol><li>先 pull 一下镜像</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> pull</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> dockerpull.org/nginx:1.16.1</span><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">  # 使用dockerpull.org的源</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>新建一个 <code>docker-compose.ym</code>文件</li></ol><div class="language-yml line-numbers-mode" data-highlighter="shiki" data-ext="yml" data-title="yml" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">version</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">&quot;3&quot;</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">services</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">  web</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">    #定义主机名</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">    container_name</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">mynginx</span></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">    #使用的镜像</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">    image</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">dockerpull.org/nginx:1.16.1</span></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">    #容器的映射端口</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">    ports</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">80:80</span></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">    #定义挂载点</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">    volumes</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">:</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">./html:/usr/share/nginx/html</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">./conf/nginx.conf:/etc/nginx/nginx.conf</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">./conf.d:/etc/nginx/conf.d</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">      - </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">./logs:/var/log/nginx</span></span>
<span class="line"><span style="--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic;">    #docker 重启后，容器自启动</span></span>
<span class="line"><span style="--shiki-dark:#F92672;--shiki-light:#E45649;">    restart</span><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">: </span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">always</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>启动 docker</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">docker</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> compose</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> up</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;"> -d</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="注册为服务-实现容器开机自启动" tabindex="-1"><a class="header-anchor" href="#注册为服务-实现容器开机自启动"><span>注册为服务，实现容器开机自启动</span></a></h3><ol><li>创建 systemd 服务文件</li></ol><p>在<code>/etc/systemd/system/</code>目录下创建一个新的服务文件</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">sudo</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> nano</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> /etc/systemd/system/docker-compose-app.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>添加以下内容到该文件</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">[Unit]</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">Description</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">Docker</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> Compose</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> Application</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> Service</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">Requires</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">docker.service</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">After</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">docker.service</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">[Service]</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">WorkingDirectory</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">/path/to/your/docker-compose/project</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">ExecStart</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">docker</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> compose</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> up</span><span style="--shiki-dark:#AE81FF;--shiki-light:#986801;"> -d</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">ExecStop</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">docker</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> compose</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> down</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">[Install]</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">WantedBy</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">multi-user.target</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>启用并启动该服务</li></ol><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">sudo</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> systemctl</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> enable</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> docker-compose-app.service</span></span>
<span class="line"><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;">sudo</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> systemctl</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> start</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> docker-compose-app.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="将启动-java-后台注册为服务" tabindex="-1"><a class="header-anchor" href="#将启动-java-后台注册为服务"><span>将启动 java 后台注册为服务</span></a></h1><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA;"><pre class="shiki shiki-themes monokai one-light vp-code"><code><span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">[Unit]</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">Description</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">Spring</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> Boot</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> Application</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">After</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">syslog.target</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">[Service]</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">User</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">lzc</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">WorkingDirectory</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">/home/lzc/java/jars</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">ExecStart</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">/home/lzc/java/openlogic-openjdk-jre-17.0.13+11-linux-x64/bin/java</span><span style="--shiki-dark:#A6E22E;--shiki-light:#4078F2;"> -jar</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;"> /home/lzc/java/jars/dpInspect-0.0.1-SNAPSHOT.jar</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">SuccessExitStatus</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">143</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">TimeoutStopSec</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">10</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">Restart</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">no</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">RestartSec</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#383A42;">[Install]</span></span>
<span class="line"><span style="--shiki-dark:#F8F8F2;--shiki-light:#E45649;">WantedBy</span><span style="--shiki-dark:#F92672;--shiki-light:#383A42;">=</span><span style="--shiki-dark:#E6DB74;--shiki-light:#50A14F;">multi-user.target</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="参考" tabindex="-1"><a class="header-anchor" href="#参考"><span>参考</span></a></h4><blockquote><p><a href="https://www.oryoy.com/news/shi-yong-docker-compose-shi-xian-rong-qi-kai-ji-zi-qi-dong-ji-shun-xu-kong-zhi-de-zui-jia-shi-jian.html" target="_blank" rel="noopener noreferrer">使用 Docker Compose 实现容器开机自启动及顺序控制的最佳实践</a></p></blockquote>`,20),t=[l];function h(k,p){return a(),i("div",null,t)}const c=s(e,[["render",h],["__file","24112206.html.vue"]]),o=JSON.parse('{"path":"/article/server/2024/24112206.html","title":"docker 安装 nginx 并注册服务实现开机自启（systemctl 操作）","lang":"zh-CN","frontmatter":{"date":"2024-11-22T00:00:00.000Z","categories":["Linux","Server"],"tags":["ubuntu"],"description":"docker 安装 nginx 并注册服务实现开机自启（systemctl 操作） 安装配置 nginx 先 pull 一下镜像 新建一个 docker-compose.ym文件 启动 docker 注册为服务，实现容器开机自启动 创建 systemd 服务文件 在/etc/systemd/system/目录下创建一个新的服务文件 添加以下内容到该文件...","head":[["meta",{"property":"og:url","content":"http://zesionlee.cn/article/server/2024/24112206.html"}],["meta",{"property":"og:site_name","content":"全栈笔记"}],["meta",{"property":"og:title","content":"docker 安装 nginx 并注册服务实现开机自启（systemctl 操作）"}],["meta",{"property":"og:description","content":"docker 安装 nginx 并注册服务实现开机自启（systemctl 操作） 安装配置 nginx 先 pull 一下镜像 新建一个 docker-compose.ym文件 启动 docker 注册为服务，实现容器开机自启动 创建 systemd 服务文件 在/etc/systemd/system/目录下创建一个新的服务文件 添加以下内容到该文件..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-11-22T06:32:12.000Z"}],["meta",{"property":"article:author","content":"阿琛"}],["meta",{"property":"article:tag","content":"ubuntu"}],["meta",{"property":"article:published_time","content":"2024-11-22T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-22T06:32:12.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"docker 安装 nginx 并注册服务实现开机自启（systemctl 操作）\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-11-22T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-22T06:32:12.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"阿琛\\",\\"url\\":\\"http://zesionlee.cn\\"}]}"]]},"headers":[{"level":3,"title":"安装配置 nginx","slug":"安装配置-nginx","link":"#安装配置-nginx","children":[]},{"level":3,"title":"注册为服务，实现容器开机自启动","slug":"注册为服务-实现容器开机自启动","link":"#注册为服务-实现容器开机自启动","children":[]}],"git":{"createdTime":1732247468000,"updatedTime":1732257132000,"contributors":[{"name":"zesionlee","email":"39211025+zesion21@users.noreply.github.com","commits":2}]},"readingTime":{"minutes":1.08,"words":323},"filePathRelative":"article/server/2024/24112206.md","localizedDate":"2024年11月22日","excerpt":"\\n<h3>安装配置 nginx</h3>\\n<ol>\\n<li>先 pull 一下镜像</li>\\n</ol>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-dark:#F8F8F2;--shiki-light:#383A42;--shiki-dark-bg:#272822;--shiki-light-bg:#FAFAFA\\"><pre class=\\"shiki shiki-themes monokai one-light vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-dark:#A6E22E;--shiki-light:#4078F2\\">docker</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\"> pull</span><span style=\\"--shiki-dark:#E6DB74;--shiki-light:#50A14F\\"> dockerpull.org/nginx:1.16.1</span><span style=\\"--shiki-dark:#88846F;--shiki-light:#A0A1A7;--shiki-dark-font-style:inherit;--shiki-light-font-style:italic\\">  # 使用dockerpull.org的源</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{c as comp,o as data};
