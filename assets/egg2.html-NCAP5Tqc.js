import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as n,a as s,o as a}from"./app-DQ5ndBT9.js";const t={};function l(r,i){return a(),n("div",null,[...i[0]||(i[0]=[s(`<h2 id="runtime-environment" tabindex="-1"><a class="header-anchor" href="#runtime-environment"><span>Runtime Environment</span></a></h2><p>A Web application itself should be stateless and have the ability to set itself according to the runtime environment.<br> Original document address: <a href="https://eggjs.org/zh-cn/basics/env.html" target="_blank" rel="noopener noreferrer">Runtime Environment</a></p><h2 id="specifying-the-runtime-environment" tabindex="-1"><a class="header-anchor" href="#specifying-the-runtime-environment"><span>Specifying the Runtime Environment</span></a></h2><p>It is specified through the <code>config/env</code> file. The content of this file is the runtime environment, such as <code>prod</code>.</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>// config/env</span></span>
<span class="line"><span>prod</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="getting-the-runtime-environment-within-the-application" tabindex="-1"><a class="header-anchor" href="#getting-the-runtime-environment-within-the-application"><span>Getting the Runtime Environment Within the Application</span></a></h2><p>The framework provides the variable <code>app.config.env</code> to represent the application&#39;s current runtime environment.</p><h2 id="custom-environments" tabindex="-1"><a class="header-anchor" href="#custom-environments"><span>Custom Environments</span></a></h2><p>A conventional development process may have more than just the environments mentioned above. Egg supports custom environments to adapt to your own development workflows.</p><p>For example, to add an integration testing environment SIT to the development workflow. Set <code>EGG_SERVER_ENV</code> to sit (and it is recommended to set <code>NODE_ENV = production</code>). Upon startup, <code>config/config.sit.js</code> will be loaded, and the runtime environment variable <code>app.config.env</code> will be set to sit.</p><h2 id="config-configuration" tabindex="-1"><a class="header-anchor" href="#config-configuration"><span>Config Configuration</span></a></h2><p>The framework provides powerful and extendable configuration capabilities. It can automatically merge configurations from the application, plugins, and the framework, overwriting them sequentially, and can maintain different configurations depending on the environment. The merged configuration can be directly obtained from <code>app.config</code>.</p><h3 id="multi-environment-configuration" tabindex="-1"><a class="header-anchor" href="#multi-environment-configuration"><span>Multi-environment Configuration</span></a></h3><p>The framework supports loading configurations based on the environment and defining configuration files for multiple environments. For specific environments, please refer to <a href="https://eggjs.org/zh-cn/basics/env.html" target="_blank" rel="noopener noreferrer">Runtime Environment Configuration</a>.</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>config</span></span>
<span class="line"><span>|- config.default.js</span></span>
<span class="line"><span>|- config.prod.js</span></span>
<span class="line"><span>|- config.unittest.js</span></span>
<span class="line"><span>\`- config.local.js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>config.default.js</code> is the default configuration file, and all environments will load this configuration file. It generally also serves as the default configuration file for the development environment.<br> When an env is specified, both the default configuration and the corresponding named configuration file will be loaded. The named configuration and the default configuration will be merged (using extend2 deep clone) into the final configuration. Named configuration items will overwrite items with the same name in the default configuration file. For instance, the <code>prod</code> environment will load both <code>config.prod.js</code> and <code>config.default.js</code> files, and <code>config.prod.js</code> will overwrite the corresponding configurations in <code>config.default.js</code>.</p><h3 id="configuration-syntax" tabindex="-1"><a class="header-anchor" href="#configuration-syntax"><span>Configuration Syntax</span></a></h3><p>The configuration file returns an object. It can overwrite some framework configurations, and applications can also place their own business configurations here for convenient management.</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Configure the directory for logger files; the default logger configuration is provided by the framework</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  logger</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    dir</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;/home/admin/logs/demoapp&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The configuration file can also be simplified into the <code>exports.key = value</code> format.</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">keys</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;my-cookie-secret-key&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">logger</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  level</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;DEBUG&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The configuration file can also return a function, which can accept <code>appInfo</code> as an argument.</p><div class="language-js line-numbers-mode" data-highlighter="shiki" data-ext="js" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-js"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Place the logger directory under the code directory</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#986801;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> require</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;path&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">module</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">exports</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">appInfo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    logger</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      dir</span><span style="--shiki-light:#0184BC;--shiki-dark:#ABB2BF;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> path</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;">appInfo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">baseDir</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;logs&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    },</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  };</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">AI Translation | AI 翻译</p><p>This article was translated from Chinese to English by AI. If there are any inaccuracies, please refer to the original Chinese version.<br><br><br> 本文由 AI 辅助从中文翻译为英文。如遇不准确之处，请以中文原版为准。</p></div>`,24)])])}const p=e(t,[["render",l]]),d=JSON.parse('{"path":"/en/article/node/2021/egg2.html","title":"Egg Learning Notes (2) - Runtime Environment and Configuration","lang":"en-US","frontmatter":{"title":"Egg Learning Notes (2) - Runtime Environment and Configuration","date":"2021-07-29T00:00:00.000Z","tags":["egg"],"categories":["Node"],"description":"Runtime Environment A Web application itself should be stateless and have the ability to set itself according to the runtime environment. Original document address: Runtime Envi...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Egg Learning Notes (2) - Runtime Environment and Configuration\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2021-07-29T00:00:00.000Z\\",\\"dateModified\\":\\"2026-02-25T06:27:11.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"阿琛\\",\\"url\\":\\"http://zesionlee.cn\\"}]}"],["meta",{"property":"og:url","content":"http://zesionlee.cn/en/article/node/2021/egg2.html"}],["meta",{"property":"og:title","content":"Egg Learning Notes (2) - Runtime Environment and Configuration"}],["meta",{"property":"og:description","content":"Runtime Environment A Web application itself should be stateless and have the ability to set itself according to the runtime environment. Original document address: Runtime Envi..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:locale:alternate","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-25T06:27:11.000Z"}],["meta",{"property":"article:tag","content":"egg"}],["meta",{"property":"article:published_time","content":"2021-07-29T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-25T06:27:11.000Z"}],["link",{"rel":"alternate","hreflang":"zh-cn","href":"http://zesionlee.cn/article/node/2021/egg2.html"}]]},"git":{"createdTime":1772000831000,"updatedTime":1772000831000,"contributors":[{"name":"zesion21","username":"zesion21","email":"39211025+zesion21@users.noreply.github.com","commits":1,"url":"https://github.com/zesion21"}]},"readingTime":{"minutes":1.69,"words":508},"filePathRelative":"en/article/node/2021/egg2.md","excerpt":"<h2>Runtime Environment</h2>\\n<p>A Web application itself should be stateless and have the ability to set itself according to the runtime environment.<br>\\nOriginal document address: <a href=\\"https://eggjs.org/zh-cn/basics/env.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Runtime Environment</a></p>","autoDesc":true}');export{p as comp,d as data};
